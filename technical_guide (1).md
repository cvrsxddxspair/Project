# Техническое руководство по созданию Telegram-бота для гороскопов

## Содержание
1. [Введение](#введение)
2. [Требования](#требования)
3. [Установка и настройка](#установка-и-настройка)
4. [Архитектура проекта](#архитектура-проекта)
5. [Пошаговая инструкция](#пошаговая-инструкция)
6. [Примеры использования](#примеры-использования)
7. [Устранение неполадок](#устранение-неполадок)

## Введение

Данное руководство описывает процесс создания Telegram-бота для получения гороскопов с использованием Python и библиотеки pyTelegramBotAPI. Бот позволяет пользователям получать ежедневные гороскопы для различных знаков зодиака.

## Требования

### Системные требования
- Python 3.8 или выше
- pip (менеджер пакетов Python)
- Доступ к интернету
- Токен Telegram-бота

### Необходимые библиотеки
```python
pyTelegramBotAPI==4.12.0
requests==2.31.0
python-dotenv==1.0.0
```

## Установка и настройка

1. Клонируйте репозиторий:
```bash
git clone <URL репозитория>
cd <папка проекта>
```

2. Установите зависимости:
```bash
pip install -r src/requirements.txt
```

3. Создайте файл `.env` в папке `src`:
```bash
BOT_TOKEN=ваш_токен_телеграм_бота
```

4. Запустите бота:
```bash
python src/main.py
```

## Архитектура проекта

### Структура проекта
```
src/
├── main.py           # Основной файл бота
├── requirements.txt  # Зависимости проекта
└── .env             # Конфигурационный файл
```

### Основные компоненты
1. **Обработчики команд**
   - `/start`, `/hello` - приветственные сообщения
   - `/horoscope` - получение гороскопа

2. **Функции для работы с API**
   - `get_daily_horoscope()` - получение гороскопа с внешнего API

3. **Обработка диалога**
   - Выбор знака зодиака
   - Выбор даты
   - Отправка результата

## Пошаговая инструкция

### 1. Создание бота в Telegram
1. Откройте [@BotFather](https://t.me/BotFather) в Telegram
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания бота
4. Сохраните полученный токен

### 2. Настройка окружения
```python
import os
import telebot
import requests
from dotenv import load_dotenv

# Загрузка переменных окружения
load_dotenv()

# Инициализация бота
BOT_TOKEN = os.environ.get('BOT_TOKEN')
bot = telebot.TeleBot(BOT_TOKEN)
```

### 3. Создание обработчиков команд
```python
@bot.message_handler(commands=['start', 'hello'])
def send_welcome(message):
    bot.reply_to(message, "Привет! Я бот-астролог. Используй /horoscope чтобы получить свой гороскоп!")
```

### 4. Реализация диалога
```python
@bot.message_handler(commands=['horoscope'])
def sign_handler(message):
    text = "Какой у вас знак зодиака?"
    sent_msg = bot.send_message(message.chat.id, text)
    bot.register_next_step_handler(sent_msg, day_handler)
```

## Примеры использования

### Получение гороскопа
1. Отправьте команду `/horoscope`
2. Выберите знак зодиака
3. Выберите дату
4. Получите результат

### Пример взаимодействия
```
Пользователь: /horoscope
Бот: Какой у вас знак зодиака?
Пользователь: Aries
Бот: На какой день показать гороскоп?
Пользователь: TODAY
Бот: *Aries* на *2024-02-20*
[Текст гороскопа]
```

## Устранение неполадок

### Частые проблемы и решения

1. **Ошибка подключения к API**
   - Проверьте подключение к интернету
   - Убедитесь в доступности API-сервиса

2. **Ошибка авторизации бота**
   - Проверьте правильность токена в файле `.env`
   - Убедитесь, что бот не был остановлен в BotFather

3. **Ошибки при получении гороскопа**
   - Проверьте правильность ввода знака зодиака
   - Убедитесь в корректности формата даты

### Логирование
В случае ошибок проверьте консоль на наличие сообщений об ошибках. 